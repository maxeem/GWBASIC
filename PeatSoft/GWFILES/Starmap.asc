10 DEF SEG=&H40:POKE &H17,(PEEK(&H17)AND &HFFBF)+64
20 KEY OFF:CLS:WIDTH 40
30 LOCATE 2,15:PRINT"STAR MAPS":LOCATE 3,15:PRINT"---------"
40 LOCATE 5,4:PRINT"Converted by Allan & Andrew Lee"
50 PRINT::PRINT:INPUT"What is your latitude?-->",LA
60 IF LA>90 OR LA<-90 THEN LA=41
70 PRINT:PRINT:PRINT"   To accent any constellation type its":PRINT:INPUT"first three letters -->",E$
80 PRINT:PRINT:PRINT"    To accent a star-type it's first":PRINT:PRINT"three letters.  Type <SUN> to accent the":INPUT"solar system -->",C$
90 C$=RIGHT$(C$,3)
100 CLS:PRINT"   After chart is displayed hit space":PRINT:PRINT"bar to advance one hour, <E> to draw":PRINT:PRINT"celestial equator, <D> to enter new date":PRINT"or <Q> to quit."
110 PRINT:PRINT:INPUT"   Date (MM,DD,YY (82-85)) -->",M,D,YY
120 IF M<0 OR M>12 THEN 110
130 IF D<0 OR D>31 THEN 110
140 PRINT:PRINT:PRINT"   Chart time-use standard time and":PRINT:INPUT"24 hour format to nearest hour.-->",H
150 H=INT(H):DY=0
160 IF H<0 OR H>24 THEN 140
170 DATA 0,31,28,31,30,31,30,31,31,30,31,30,31,-99
180 FOR J=1 TO M:READ DD:DY=DY+DD:NEXT
190 READ Z
200 IF Z=-99 THEN GOTO 220
210 GOTO 190
220 DY=DY+D
230 SCREEN 1:CLS
240 DATA ERI,ACH,1.6,-57
250 DATA UMA,Z,10.8,61.8
260 DATA UMA,Z,10.8,57
270 DATA UMA,Z,11.7,54
280 DATA UMA,Z,12.1,57
290 DATA CAS,Z,.6,56.4
300 DATA CEP,Z,21,62.5
310 DATA GRU,Z,22.6,-47
320 DATA AUR,Z,5.9,45
330 DATA CMA,Z,6.8,-26.8
340 DATA CRU,ACR,12.4,-63
350 DATA UMA,Z,12.7,55
360 DATA UMA,Z,13.3,53
370 DATA UMA,Z,13.6,50
380 DATA TAU,ALD,4.6,16
390 DATA AQU,ALT,19.8,9
400 DATA SCO,ANT,16.5,-26
410 DATA BOO,ARC,14.2,19
420 DATA CRU,BEC,12.7,-60
430 DATA ORI,BET,5.9,7
440 DATA CAR,CAN,6.4,-63
450 DATA AUG,CAP,5.2,46
460 DATA CYG,DEN,28.7,45
470 DATA FAU,FOM,22.9,-30
480 DATA CNE,HAD,14,-60
490 DATA GEM,POL,7.7,28
500 DATA CMI,PRO,7.6,5
510 DATA LEO,REG,10.1,12
520 DATA ORI,RIG,5.3,-8
530 DATA CEN,RIG,14.6,-61
540 DATA CMA,"STR",6.7,-17
550 DATA VIR,SPI,13.4,-11
560 DATA LYR,VEG,18.6,39
570 DATA PEG,Z,.1,29
580 DATA PEG,Z,.1,15
590 DATA PEG,Z,23,29
600 DATA PEG,Z,23,15
610 DATA UMI,Z,1,90
620 DATA UMI,Z,14.7,74
630 DATA PHO,Z,4,-42,CET,Z,.4,-18,"AND",Z,1,35,"AND",Z,2,42,"ARE",Z,2,23,CET,Z,2.3,-3
640 DATA ORI,Z,5.7,-9.6,AUR,Z,5.9,45,CMA,Z,6.3,-18,GEM,Z,6.4,16.4,CMA,Z,6.9,-26,CMA,Z,7.3,-29
650 DATA PER,Z,3,41,PER,Z,3.3,50,ORI,Z,5.4,6.3,TAU,Z,5.4,28.6
660 DATA GEM,Z,7.4,32,PUP,Z,8,-40,VEL,Z,8.1,-47
670 DATA HYD,Z,9.3,-8.6,LEO,Z,10.1,20,LEO,Z,11.8,14.7,CRU,Z,12.4,-57,CEN,Z,12.7,-49,CEN,Z,14.6,27
680 DATA CEN,Z,14.1,-36.2,CEN,Z,14.5,-42,LUP,Z,14.6,-47,BOO,Z,14.6,27
690 DATA CBO,Z,15.5,26.3,SCO,Z,15.9,-22.5,SCO,Z,16.7,-34.2,OPH,Z,17.1,-15.7,SCO,Z,17.5,-37,OPH,Z,17.5,12.5
700 DATA SCO,Z,17.5,-43,SCO,Z,17.6,-39,DRA,Z,17.7,51.5,SAG,Z,18.3,67,SAG,Z,19.2,-26
710 DATA CYG,Z,20,40,PAY,Z,20.4,-56,CYG,Z,20.6,33.9,PEG,Z,21.6,9.7,GRU,Z,22.3,-47
720 DATA PER,Z,3.3,50
730 DATA CAS,Z,.1,58
740 DATA CAS,Z,.5,55
750 DATA CAS,Z,1,60
760 DATA CAS,Z,1.4,58
770 DATA CAS,Z,1.9,62
780 DATA ORI,Z,5.5,0
790 DATA ORI,Z,5.65,-2
800 DATA ORI,Z,5.8,-4
810 DATA XXX,XXX,0,0
820 FOR J=152 TO 168 STEP 4:PSET(J,90):NEXT
830 FOR J=84 TO 98 STEP 4:PSET(160,J):NEXT
840 CIRCLE(160,90),90
850 DRAW"bm34,60r4l4d2r2l2d2r4"
860 DRAW"bm290,60d4e4f4u4"
870 READ F$,B$,A,B
880 IF B$="XXX" THEN 1020
890 A=24-A
900 T=DY/15+H:A=A+T+12:B=ABS(B-90)
910 IF A>24 THEN A=A-24:GOTO 910
920 A=A*15
930 Y=SIN(A/57.296)*B+LA
940 X=160-(COS(A/57.296)*B)
950 IF Y<0 OR Y>190 THEN 870
960 IF X<38 OR X>282 THEN 1010
970 PSET(X,Y)
980 IF B$<>"Z" THEN CIRCLE(X,Y),1
990 IF F$=E$ THEN CIRCLE(X,Y),1
1000 IF B$=C$ THEN CIRCLE(A,B),2
1010 GOTO 870
1020 GOSUB 1290:GOSUB 1140
1030 RESTORE:FOR J=1 TO 14:READ Z:NEXT
1040 IF H>24 THEN CLS:PRINT"Reset, start again.":GOTO 110
1050 I$=INKEY$:IF I$="Q"OR I$="q"THEN CLS:END
1060 IF I$="E"OR I$="e"THEN CIRCLE(160,LA),90,1,,,.45:GOTO 1040
1070 IF I$="D"OR I$="d"THEN RESTORE:CLS:GOTO 110
1080 IF I$=""THEN 1040
1090 CLS:H=H+1:GOTO 810
1100 IF H=7 OR H=17 THEN DRAW"bm290,150r8m-8,+12"
1110 IF H=8 OR H=18 THEN DRAW"bm290,150br4r2f2d1g2f3d2g2L2u2e3nr2h2u1e2"
1120 IF H=9 OR H=19 THEN DRAW"bm290,150br2r3f2d8g2l3h2bu6u2e2bd6nh2r3e2"
1130 IF H=10 OR H=20 THEN DRAW"bm290,150br2r3f2d8g2l3h2u8e2"
1140 IF H>24 THEN H=N-24:DY=DY+1
1150 IF H=1 OR H=11 OR H=21 THEN DRAW"bm290,150d12"
1160 IF H=2 OR H=12 OR H=22 THEN DRAW"bm290,152E2R2F2D1G7D2R7"
1170 IF H=3 OR H=13 OR H=23 THEN DRAW"bm290,152E2r3F2D2G2NL3F2D2G2L3H2
1180 IF H=4 OR H=14 OR H=24 THEN DRAW"bm290,150Bd6NE6r10l4u6d12"
1190 IF H=5 OR H=15 THEN DRAW"bm290,150BR2nr6d4r4f2d2g2l3h2
1200 IF H=6 OR H=16 THEN DRAW"bm290,150br2nr5g2d8f2r4e2u3h2l4g2"
1210 IF H=7 OR H=17 OR H=27 THEN DRAW"bm290,150r8m-8,+12"
1220 IF H=8 OR H=18 OR H=28 THEN DRAW"bm290,150br4r2f2d1g2f3d2g2L4h2u2e3nr2h2u1e2"
1230 IF H=9 OR H=19 THEN DRAW"bm290,150br2r3f2d8g2l3h2bu6u2e2bd6nh2r3e2"
1240 IF H=10 OR H=20 THEN DRAW"bm290,150br2r3f2d8g2l3h2u8e2"
1250 IF H>9 AND H<20 THEN DRAW"bm280,150d12"
1260 IF H>19 THEN DRAW"bm278,152E2R2F2D1G7D2R7"
1270 SOUND 200,8
1280 RETURN
1290 Y1=YY-82
1300 DE=DY+9:IF DE>365 THEN DE=DE-365
1310 DE=DE/57.296:E=COS(DE/365*360)*23
1320 A=H-6:IF H<6 OR H>18 THEN 1600
1330 IF C$<>"sun" THEN 1360
1340 GOSUB 1600
1350 CIRCLE(X,Y),4:PAINT(X,Y),1,3
1360 IF YY<82 OR YY>85 THEN RETURN
1370 MM=M+Y1*12
1380 FOR Z=1 TO MM:READ YA,MA,JA,SA:NEXT
1390 IF YA=0 THEN 1430
1400 A=VA/15+(H-6):GOSUB 1600:GOSUB 1660:IF Y<LA THEN GOTO 1420
1410 PSET(X,182):DRAW"M+2,6M+2,-6"
1420 IF MA=0 THEN 1460
1430 A=MA+T:GOSUB 1600:GOSUB 1660:IF Y<LA THEN 1450
1440 PSET(X-1,194):DRAW"U6M+3,+6M+3,-6D6"
1450 IF JA=0 THEN 1490
1460 A=JA+T:GOSUB 1600:GOSUB 1660:IF Y<LA THEN GOTO 1480
1470 PSET(X+2,188):DRAW"D5G1L2H1U2"
1480 IF SA=0 THEN RETURN
1490 A=SA+T:GOSUB 1600:GOSUB 1660:IF Y<LA THEN RETURN
1500 PSET(X+2,175):DRAW"H1L2G1D1M+4,3F1D1G1L3H1"
1510 RETURN
1520 DATA 0,12,8,14,4,13,4,33,13,2,14.5,13.4,45,13,14.5,13.3,46,12.4,14.3,13.2,42,12.1,14.1,13.1,36,12.4,13.9,13
1530 DATA 29,13.2,13.9,13,21,13.9,14.1,13.2,13,15.6,14.4,13.4,0,17.1,14.8,0,0,18.8,0,13.8,-11,20.4,15.7,14
1540 DATA -18,22,16.1,14.1,-25,23.5,16.5,14.2,-31,.8,16.6,14.1,-31,2.3,16.6,14,-43,0,16.4,13.9,-45,0,16.1,13.8,-41,6.8,16,13.8,-15,8.2,16,13.9,29,9.6,16.2,14
1550 DATA 44,10.7,16.5,14.2,46,11.9,16.9,14.5,42,13,0,14.7
1560 DATA 37,14,17.9,14.9,31,15,18.4,15,24,15.6,18.7,15,15,15.7,18.9,14.9,0,15.1,18.9,14.7,0,14.6,18.7,14.6
1570 DATA 0,14.8,18.5,14.5,-16,15.7,18.2,14.6,-25,17,18.2,14.7,-32,18.5,18.5,14.9,-39,20.1,18.8,0,-44,21.7,19.3,15.4
1580 DATA -47,23.1,0,15.6,-45,.6,20.3,15.7,-28,1.8,28.7,15.8,18,3.3,21,15.7,41,4.7,21.3,15.5,46,0,21.3,15.4
1590 DATA 43,0,21.1,15.3,38,0,20.9,15.3,30,10.4,20.7,15.4,23,11.1,20.7,15.6,16,12.7,20,8,0,0,13.9,21.2,16.1
1600 B=90:A=A*15
1610 X=160-(COS(A/57.296)*B)
1620 IF X<38 OR X>282 THEN RETURN
1630 Y=SIN(A/57.296)*B
1640 Y=Y+LA+E
1650 RETURN
1660 IF X<38 OR X>282 THEN RETURN
1670 IF Y<LA THEN RETURN
1680 CIRCLE(X,Y),1:IF C$="SUN"THEN CIRCLE(X,Y),2:RETURN
1690 RETURN
