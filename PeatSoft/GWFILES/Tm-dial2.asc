1 '****** MODIFICATION FOR PC-TALK, VERSION 2.0*****************
2 '
3 'FILENAME: TM-DIAL2
4 '
5 'PURPOSE;  PROVIDE AUTOMATIC READIAL FUNCTION.
6 '
7 'DIRECTIONS: DELETE THE FIRST 10 LINES OF THIS FILE.  THEN SAVE AS
8 '            AN ASCII FILE (USE ",A OPTION OF BASIC SAVE COMMAND)
9 '            AND MERGE WITH VERSION 2.0 OF PC-TALK.
10 '*************************************************************
152 REDIALDELAY=30  'delay aprox. in seconds. Should be = or > S7 modem param.
1075 '         - redial last # -
1080 IF CODE=16 AND DIAL$="" THEN BEEP:GOTO 400
1085 IF CODE=16 THEN GOTO 10100
1090 REDIALDELAY=3000:'
10100 '   -  Alt-Q Redial -
10110 '
10120 REDIAL=NOT REDIAL
10130 IF NOT REDIAL THEN PRINT"Redial Terminated.....":PRINT #1,CHR$(13):GOTO 400
10135 CLS:LOCATE 25,50:PRINT "Redial started at ";TIME$
10140 SOUND 750,1:SOUND 600,1
10150 PRINT: PRINT "Re-dialing ";N$;:PRINT R$:PRINT "Time = ";TIME$
10152 LOCATE 25,1:PRINT "REDIALING     ";:COLOR 23,0:PRINT"** HIT ANY KEY TO TERMINATE **":COLOR 7,0
10154 ZZ$="AT V1Q0E1 S0=0 "+MID$(MODEM$,3)
10155 PRINT #1, ZZ$+R$+CHR$(13)
10170  FOR I=1 TO 1000
10180  NEXT I
10190 WHILE NOT EOF(1)
10200 W$=INPUT$(LOC(1),#1)
10210 WEND
10250 IF EOF(1) THEN 10250
10255  FOR YZ!= 1 TO REDIALDELAY
10260 Q$=INPUT$(LOC(1),#1)
10270  FOR N=1 TO LEN(Q$)
10310 IF MID$(Q$,N,2)="CO" THEN PRINT Q$: GOTO 10350
10311 IF MID$(Q$,N,2)="NO" THEN LOCATE 24,1,0: PRINT MID$(Q$,N,10);
10315  NEXT N
10320 IF INKEY$<>"" THEN 10360
10330  FOR XZXZ= 1 TO 1000: NEXT XZXZ   ' Pause needed here for buffer fill
10340  NEXT YZ!
10345 GOTO 10140
10350 IF INKEY$="" THEN SOUND 600,4:SOUND 900,4:GOTO 10350
10360 CLS:LOCATE 12,20,1:PRINT"You are back in terminal operation . . . . ."
10370 REDIAL=FALSE:GOTO 400
